<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>Description of test_intTens</title>
  <meta name="keywords" content="test_intTens">
  <meta name="description" content="">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html &copy; 2005 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../m2html.css">
  <script type="text/javascript">
    if (top.frames.length == 0) { top.location = "../index.html"; };
  </script>
</head>
<body>
<a name="_top"></a>
<!-- menu.html test -->
<h1>test_intTens
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="box"><strong></strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="box"><strong>function [] = test_intTens() </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="fragment"><pre class="comment"></pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../matlabicon.gif)">
<li><a href="../src/intTens.html" class="code" title="function [Fint] = intTens(F, dim, gridT, w)">intTens</a>	F - ktensor</li></ul>
This function is called by:
<ul style="list-style-image:url(../matlabicon.gif)">
</ul>
<!-- crossreference -->



<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="fragment"><pre>0001 <a name="_sub0" href="#_subfunctions" class="code">function [] = test_intTens()</a>
0002 
0003 addpath(<span class="string">'../src/'</span>)
0004 
0005 U{1} = [4 5 6]';
0006 U{2} = [10 20 30]';
0007 tt = ktensor(U);
0008 
0009 grid{1} = 1:3;
0010 grid{2} = 1:3;
0011 
0012 ww{1} = ones(3,1);
0013 ww{2} = ones(3,1);
0014 
0015 assert(<a href="../src/intTens.html" class="code" title="function [Fint] = intTens(F, dim, gridT, w)">intTens</a>(tt) == 400)
0016 assert(<a href="../src/intTens.html" class="code" title="function [Fint] = intTens(F, dim, gridT, w)">intTens</a>(tt,[1 2]) == 400)
0017 assert(<a href="../src/intTens.html" class="code" title="function [Fint] = intTens(F, dim, gridT, w)">intTens</a>(tt,[1 2],grid) == 400)
0018 assert(<a href="../src/intTens.html" class="code" title="function [Fint] = intTens(F, dim, gridT, w)">intTens</a>(tt,[],grid) == 400)
0019 assert(<a href="../src/intTens.html" class="code" title="function [Fint] = intTens(F, dim, gridT, w)">intTens</a>(tt,[1 2],grid,ww) == 400)
0020 assert(<a href="../src/intTens.html" class="code" title="function [Fint] = intTens(F, dim, gridT, w)">intTens</a>(tt,[],[],ww) == 400)
0021 assert(all(double(<a href="../src/intTens.html" class="code" title="function [Fint] = intTens(F, dim, gridT, w)">intTens</a>(tt,1,grid,ww)) == [100 200 300]))
0022 assert(all(double(<a href="../src/intTens.html" class="code" title="function [Fint] = intTens(F, dim, gridT, w)">intTens</a>(tt,2,grid,ww)) == [160 200 240]'))
0023 
0024 ww{1} = [1 2 3]';
0025 ww{2} = [4 5 6]';
0026 
0027 assert(<a href="../src/intTens.html" class="code" title="function [Fint] = intTens(F, dim, gridT, w)">intTens</a>(tt,[],[],ww) == 4410)
0028 assert(all(double(<a href="../src/intTens.html" class="code" title="function [Fint] = intTens(F, dim, gridT, w)">intTens</a>(tt,1,[],ww)) == [210 420 630]))
0029 assert(all(double(<a href="../src/intTens.html" class="code" title="function [Fint] = intTens(F, dim, gridT, w)">intTens</a>(tt,2,[],ww)) == [840 1050 1260]'))
0030 
0031 U{1} = [4 5 6; 4 5 6]';
0032 U{2} = [10 20 30; 10 20 30]';
0033 tt = ktensor(U);
0034 
0035 assert(<a href="../src/intTens.html" class="code" title="function [Fint] = intTens(F, dim, gridT, w)">intTens</a>(tt,[],[],ww) == trapz(trapz(double(tt).*repmat(ww{1},1,3).*repmat(ww{2}',3,1))))
0036 assert(<a href="../src/intTens.html" class="code" title="function [Fint] = intTens(F, dim, gridT, w)">intTens</a>(tt,[1 2],[],ww) == trapz(trapz(double(tt).*repmat(ww{1},1,3).*repmat(ww{2}',3,1))))
0037 assert(all(double(<a href="../src/intTens.html" class="code" title="function [Fint] = intTens(F, dim, gridT, w)">intTens</a>(tt,1,[],ww)) == trapz(double(tt).*repmat(ww{1},1,3))))
0038 assert(all(double(<a href="../src/intTens.html" class="code" title="function [Fint] = intTens(F, dim, gridT, w)">intTens</a>(tt,2,[],ww)) == trapz(double(tt).*repmat(ww{2}',3,1),2)))
0039 
0040 lambda = [2 6]';
0041 U{1} = [4 5 6; 1 2 3]';
0042 U{2} = [10 20 30; 4 5 6]';
0043 tt = ktensor(lambda,U);
0044 
0045 assert(<a href="../src/intTens.html" class="code" title="function [Fint] = intTens(F, dim, gridT, w)">intTens</a>(tt,[],[],ww) == trapz(trapz(double(tt).*repmat(ww{1},1,3).*repmat(ww{2}',3,1))))
0046 assert(<a href="../src/intTens.html" class="code" title="function [Fint] = intTens(F, dim, gridT, w)">intTens</a>(tt,[1 2],[],ww) == trapz(trapz(double(tt).*repmat(ww{1},1,3).*repmat(ww{2}',3,1))))
0047 assert(all(double(<a href="../src/intTens.html" class="code" title="function [Fint] = intTens(F, dim, gridT, w)">intTens</a>(tt,1,[],ww)) == trapz(double(tt).*repmat(ww{1},1,3))))
0048 assert(all(double(<a href="../src/intTens.html" class="code" title="function [Fint] = intTens(F, dim, gridT, w)">intTens</a>(tt,2,[],ww)) == trapz(double(tt).*repmat(ww{2}',3,1),2)))
0049 
0050 d = 2;
0051 r = 9;
0052 <span class="keyword">for</span> ii = 1:d
0053     n(ii) = randi(100);
0054     U{ii} = matrandnorm(n(ii),r);
0055     ww{ii} = randn(n(ii),1);
0056     grid{ii} = sort([-5; -5+rand(n(ii)-2,1)/10; 5]);
0057 <span class="keyword">end</span>
0058 tt = ktensor(randn(r,1),U);
0059 
0060 fulltt = double(tt);
0061 assert(abs(<a href="../src/intTens.html" class="code" title="function [Fint] = intTens(F, dim, gridT, w)">intTens</a>(tt) - trapz(trapz(fulltt))) &lt;= 100*eps)
0062 assert(abs(<a href="../src/intTens.html" class="code" title="function [Fint] = intTens(F, dim, gridT, w)">intTens</a>(tt,[1 2],[]) - trapz(trapz(fulltt))) &lt;= 100*eps)
0063 assert(all(abs(double(<a href="../src/intTens.html" class="code" title="function [Fint] = intTens(F, dim, gridT, w)">intTens</a>(tt,1)) - trapz(fulltt))&lt;= 100*eps))
0064 assert(all(abs(double(<a href="../src/intTens.html" class="code" title="function [Fint] = intTens(F, dim, gridT, w)">intTens</a>(tt,2)) - trapz(fulltt,2))&lt;= 100*eps))
0065 assert(abs(<a href="../src/intTens.html" class="code" title="function [Fint] = intTens(F, dim, gridT, w)">intTens</a>(tt,[],[],ww) - trapz(trapz(fulltt.*(ww{1}*ww{2}')))) &lt;= 100*eps)
0066 assert(abs(<a href="../src/intTens.html" class="code" title="function [Fint] = intTens(F, dim, gridT, w)">intTens</a>(tt,[1 2],[],ww) - trapz(trapz(fulltt.*(ww{1}*ww{2}')))) &lt;= 100*eps)
0067 assert(all(abs(double(<a href="../src/intTens.html" class="code" title="function [Fint] = intTens(F, dim, gridT, w)">intTens</a>(tt,1,[],ww)) - trapz(fulltt.*repmat(ww{1},1,n(2))))&lt;= 100*eps))
0068 assert(all(abs(double(<a href="../src/intTens.html" class="code" title="function [Fint] = intTens(F, dim, gridT, w)">intTens</a>(tt,2,[],ww)) - trapz(fulltt.*repmat(ww{2}',n(1),1),2))&lt;= 100*eps))
0069 assert(abs(<a href="../src/intTens.html" class="code" title="function [Fint] = intTens(F, dim, gridT, w)">intTens</a>(tt,[],grid,ww) -  trapz(grid{2},trapz(grid{1},fulltt.*(ww{1}*ww{2}')))) &lt;= 100*eps)
0070 assert(abs(<a href="../src/intTens.html" class="code" title="function [Fint] = intTens(F, dim, gridT, w)">intTens</a>(tt,[1 2],grid,ww) - trapz(grid{2},trapz(grid{1},fulltt.*(ww{1}*ww{2}'))))&lt;= 100*eps)
0071 assert(all(abs(double(<a href="../src/intTens.html" class="code" title="function [Fint] = intTens(F, dim, gridT, w)">intTens</a>(tt,1,grid,ww)) - trapz(grid{1},fulltt.*repmat(ww{1},1,n(2))))&lt;= 10*eps))
0072 assert(all(abs(double(<a href="../src/intTens.html" class="code" title="function [Fint] = intTens(F, dim, gridT, w)">intTens</a>(tt,2,grid,ww)) - trapz(grid{2},fulltt.*repmat(ww{2}',n(1),1),2))&lt;= 10*eps))
0073 
0074 <span class="keyword">end</span></pre></div>
<hr><address>Generated on Fri 12-Jan-2018 11:28:53 by <strong><a href="http://www.artefact.tk/software/matlab/m2html/" target="_parent">m2html</a></strong> &copy; 2005</address>
</body>
</html>