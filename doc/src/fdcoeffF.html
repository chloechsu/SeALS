<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>Description of fdcoeffF</title>
  <meta name="keywords" content="fdcoeffF">
  <meta name="description" content="Compute coefficients for finite difference approximation for the">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html &copy; 2005 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../m2html.css">
  <script type="text/javascript">
    if (top.frames.length == 0) { top.location = "../index.html"; };
  </script>
</head>
<body>
<a name="_top"></a>
<!-- menu.html src -->
<h1>fdcoeffF
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="box"><strong>Compute coefficients for finite difference approximation for the</strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="box"><strong>function c = fdcoeffF(k,xbar,x) </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="fragment"><pre class="comment"> Compute coefficients for finite difference approximation for the
 derivative of order k at xbar based on grid values at points in x.

 This function returns a row vector c of dimension 1 by n, where n=length(x),
 containing coefficients to approximate u^{(k)}(xbar), 
 the k'th derivative of u evaluated at xbar,  based on n values
 of u at x(1), x(2), ... x(n).  

 If U is a column vector containing u(x) at these n points, then 
 c*U will give the approximation to u^{(k)}(xbar).

 Note for k=0 this can be used to evaluate the interpolating polynomial 
 itself.

 Requires length(x) &gt; k.  
 Usually the elements x(i) are monotonically increasing
 and x(1) &lt;= xbar &lt;= x(n), but neither condition is required.
 The x values need not be equally spaced but must be distinct.  

 This program should give the same results as fdcoeffV.m, but for large
 values of n is much more stable numerically.

 Based on the program &quot;weights&quot; in 
   B. Fornberg, &quot;Calculation of weights in finite difference formulas&quot;,
   SIAM Review 40 (1998), pp. 685-691.

 Note: Forberg's algorithm can be used to simultaneously compute the
 coefficients for derivatives of order 0, 1, ..., m where m &lt;= n-1.
 This gives a coefficient matrix C(1:n,1:m) whose k'th column gives
 the coefficients for the k'th derivative.

 In this version we set m=k and only compute the coefficients for
 derivatives of order up to order k, and then return only the k'th column
 of the resulting C matrix (converted to a row vector).  
 This routine is then compatible with fdcoeffV.   
 It can be easily modified to return the whole array if desired.

 From  http://www.amath.washington.edu/~rjl/fdmbook/  (2007)</pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../matlabicon.gif)">
</ul>
This function is called by:
<ul style="list-style-image:url(../matlabicon.gif)">
<li><a href="fdmatrix.html" class="code" title="function [DD] = fdmatrix( n, der, ord, per )">fdmatrix</a>	FDMATRIX Finite difference matrix for der:th order derivative with ord:th</li></ul>
<!-- crossreference -->



<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="fragment"><pre>0001 
0002 <a name="_sub0" href="#_subfunctions" class="code">function c = fdcoeffF(k,xbar,x)</a>
0003 
0004 <span class="comment">% Compute coefficients for finite difference approximation for the</span>
0005 <span class="comment">% derivative of order k at xbar based on grid values at points in x.</span>
0006 <span class="comment">%</span>
0007 <span class="comment">% This function returns a row vector c of dimension 1 by n, where n=length(x),</span>
0008 <span class="comment">% containing coefficients to approximate u^{(k)}(xbar),</span>
0009 <span class="comment">% the k'th derivative of u evaluated at xbar,  based on n values</span>
0010 <span class="comment">% of u at x(1), x(2), ... x(n).</span>
0011 <span class="comment">%</span>
0012 <span class="comment">% If U is a column vector containing u(x) at these n points, then</span>
0013 <span class="comment">% c*U will give the approximation to u^{(k)}(xbar).</span>
0014 <span class="comment">%</span>
0015 <span class="comment">% Note for k=0 this can be used to evaluate the interpolating polynomial</span>
0016 <span class="comment">% itself.</span>
0017 <span class="comment">%</span>
0018 <span class="comment">% Requires length(x) &gt; k.</span>
0019 <span class="comment">% Usually the elements x(i) are monotonically increasing</span>
0020 <span class="comment">% and x(1) &lt;= xbar &lt;= x(n), but neither condition is required.</span>
0021 <span class="comment">% The x values need not be equally spaced but must be distinct.</span>
0022 <span class="comment">%</span>
0023 <span class="comment">% This program should give the same results as fdcoeffV.m, but for large</span>
0024 <span class="comment">% values of n is much more stable numerically.</span>
0025 <span class="comment">%</span>
0026 <span class="comment">% Based on the program &quot;weights&quot; in</span>
0027 <span class="comment">%   B. Fornberg, &quot;Calculation of weights in finite difference formulas&quot;,</span>
0028 <span class="comment">%   SIAM Review 40 (1998), pp. 685-691.</span>
0029 <span class="comment">%</span>
0030 <span class="comment">% Note: Forberg's algorithm can be used to simultaneously compute the</span>
0031 <span class="comment">% coefficients for derivatives of order 0, 1, ..., m where m &lt;= n-1.</span>
0032 <span class="comment">% This gives a coefficient matrix C(1:n,1:m) whose k'th column gives</span>
0033 <span class="comment">% the coefficients for the k'th derivative.</span>
0034 <span class="comment">%</span>
0035 <span class="comment">% In this version we set m=k and only compute the coefficients for</span>
0036 <span class="comment">% derivatives of order up to order k, and then return only the k'th column</span>
0037 <span class="comment">% of the resulting C matrix (converted to a row vector).</span>
0038 <span class="comment">% This routine is then compatible with fdcoeffV.</span>
0039 <span class="comment">% It can be easily modified to return the whole array if desired.</span>
0040 <span class="comment">%</span>
0041 <span class="comment">% From  http://www.amath.washington.edu/~rjl/fdmbook/  (2007)</span>
0042 
0043 
0044 n = length(x);
0045 <span class="keyword">if</span> k &gt;= n
0046    error(<span class="string">'*** length(x) must be larger than k'</span>)
0047    <span class="keyword">end</span>
0048 
0049 m = k;   <span class="comment">% change to m=n-1 if you want to compute coefficients for all</span>
0050          <span class="comment">% possible derivatives.  Then modify to output all of C.</span>
0051 c1 = 1;
0052 c4 = x(1) - xbar;
0053 C = zeros(n-1,m+1);
0054 C(1,1) = 1;
0055 <span class="keyword">for</span> i=1:n-1
0056   i1 = i+1;
0057   mn = min(i,m);
0058   c2 = 1;
0059   c5 = c4;
0060   c4 = x(i1) - xbar;
0061   <span class="keyword">for</span> j=0:i-1
0062     j1 = j+1;
0063     c3 = x(i1) - x(j1);
0064     c2 = c2*c3;
0065     <span class="keyword">if</span> j==i-1
0066       <span class="keyword">for</span> s=mn:-1:1
0067         s1 = s+1;
0068         C(i1,s1) = c1*(s*C(i1-1,s1-1) - c5*C(i1-1,s1))/c2;
0069         <span class="keyword">end</span>
0070       C(i1,1) = -c1*c5*C(i1-1,1)/c2;
0071       <span class="keyword">end</span>
0072     <span class="keyword">for</span> s=mn:-1:1
0073       s1 = s+1;
0074       C(j1,s1) = (c4*C(j1,s1) - s*C(j1,s1-1))/c3;
0075       <span class="keyword">end</span>
0076     C(j1,1) = c4*C(j1,1)/c3;
0077     <span class="keyword">end</span>
0078   c1 = c2;
0079   <span class="keyword">end</span>
0080 <span class="comment">%c=C';</span>
0081 c = C(:,end)';            <span class="comment">% last column of c gives desired row vector</span></pre></div>
<hr><address>Generated on Fri 12-Jan-2018 11:28:53 by <strong><a href="http://www.artefact.tk/software/matlab/m2html/" target="_parent">m2html</a></strong> &copy; 2005</address>
</body>
</html>