<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>Description of diffop_region_spectral</title>
  <meta name="keywords" content="diffop_region_spectral">
  <meta name="description" content="REGIONDIFFOP Adds boundary conditions to derivative for the region.">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html &copy; 2005 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../m2html.css">
  <script type="text/javascript">
    if (top.frames.length == 0) { top.location = "../index.html"; };
  </script>
</head>
<body>
<a name="_top"></a>
<!-- menu.html src -->
<h1>diffop_region_spectral
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="box"><strong>REGIONDIFFOP Adds boundary conditions to derivative for the region.</strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="box"><strong>function [ Dpunch] = diffop_region_spectral( x, D, region) </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="fragment"><pre class="comment">REGIONDIFFOP Adds boundary conditions to derivative for the region.
 Inputs:
   x - the underlying grid. If x is a vector, then it is assumed the grid
   is uniform along each dimension
   D - the derivative operator
   region - the interval where the derivative does not apply.
 Outputs:
   Dpunch - derivative operator incooporating region.

   See also <a href="makediffop.html" class="code" title="function [D,D2,fd1,fd2] = makediffop(grid,n,h,ord_of_acc,bcon,region)">MAKEDIFFOP</a>.</pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../matlabicon.gif)">
<li><a href="als2.html" class="code" title="function [F, err, iter, e_list, t_step, illcond, noreduce] = als2(op,varargin)">als2</a>	ALS code to perform the ALS algorithm as described in Beylkin</li></ul>
This function is called by:
<ul style="list-style-image:url(../matlabicon.gif)">
</ul>
<!-- crossreference -->



<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="fragment"><pre>0001 <a name="_sub0" href="#_subfunctions" class="code">function [ Dpunch] = diffop_region_spectral( x, D, region)</a>
0002 <span class="comment">%REGIONDIFFOP Adds boundary conditions to derivative for the region.</span>
0003 <span class="comment">% Inputs:</span>
0004 <span class="comment">%   x - the underlying grid. If x is a vector, then it is assumed the grid</span>
0005 <span class="comment">%   is uniform along each dimension</span>
0006 <span class="comment">%   D - the derivative operator</span>
0007 <span class="comment">%   region - the interval where the derivative does not apply.</span>
0008 <span class="comment">% Outputs:</span>
0009 <span class="comment">%   Dpunch - derivative operator incooporating region.</span>
0010 <span class="comment">%</span>
0011 <span class="comment">%   See also MAKEDIFFOP.</span>
0012 
0013 
0014 d = length(x);
0015 opDU = cell(d,d); <span class="comment">%derivative operator in each direction</span>
0016                   <span class="comment">%column is derivative direction, row is U{i}</span>
0017                
0018 <span class="keyword">for</span> ii = 1:d
0019     
0020     d_ind = (x{ii} &gt;= region(ii,1)) &amp; (x{ii} &lt;= region(ii,2)); <span class="comment">%nodes interior</span>
0021     
0022     DCanv = D{ii};
0023     DCanv(d_ind,:) = 0; <span class="comment">%knock out the parts affecting the interior boundary</span>
0024     
0025     count = 0;
0026     <span class="keyword">if</span> d == 1
0027          opDU{ii,ii} = DCanv(:);
0028     <span class="keyword">else</span>
0029         <span class="keyword">for</span> jj = 1:d
0030             <span class="keyword">if</span> ii == jj
0031                 opDU{jj,ii} = [repmat(D{ii}(:),1,d-1) DCanv(:)];
0032             <span class="keyword">else</span>
0033                 id = eye(size(D{jj}));
0034                 idRest = id;
0035                 idRest(d_ind,:) = 0;                
0036                 opDU{jj,ii} = [repmat(id(:),1,count) idRest(:) repmat(id(:)-idRest(:),1,d-1-count)];
0037                 count = count + 1;
0038             <span class="keyword">end</span>
0039         <span class="keyword">end</span>
0040     <span class="keyword">end</span>
0041 <span class="keyword">end</span>
0042 
0043 Dpunch = cell(d,1);
0044 
0045 <span class="keyword">for</span> i=1:d
0046     Dpunch{i} = ktensor(opDU(:,i));
0047     Dpunch{i} = <a href="als2.html" class="code" title="function [F, err, iter, e_list, t_step, illcond, noreduce] = als2(op,varargin)">als2</a>(Dpunch{i},10^-8);
0048 <span class="keyword">end</span>
0049 
0050 
0051 
0052 <span class="keyword">end</span></pre></div>
<hr><address>Generated on Fri 12-Jan-2018 11:28:53 by <strong><a href="http://www.artefact.tk/software/matlab/m2html/" target="_parent">m2html</a></strong> &copy; 2005</address>
</body>
</html>